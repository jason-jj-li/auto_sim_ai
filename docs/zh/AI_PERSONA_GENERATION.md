# AI智能虚拟人群生成教程

## 概述

本功能允许您通过自然语言描述目标人群，AI会自动提取人口统计信息并生成逼真的虚拟人群。无需手动配置复杂的统计分布，只需用中文或英文描述您的研究对象即可。

## 工作原理

### 1. AI人口统计提取

- 粘贴自由格式文本描述您的目标人群
- LLM使用专门的提示词分析文本
- 提取结构化的人口统计数据（JSON格式）
- 智能解析复杂的中文人口描述

### 2. 智能分布解析

系统包含多个高级解析器，能理解自然语言人口统计信息：

- **百分比提取**："男性51.24%，女性48.76%" → 精确分布
- **范围检测**："初中至本科学历为主，涵盖文盲到博士" → 全部7个教育等级
- **关键词分析**："以汉族为主" → 加权民族分布
- **模式识别**："城镇居民63.89%" → 城乡比例

### 3. 虚拟人群生成

- 提取的人口统计信息转换为统计分布
- PersonaGenerator创建具有连贯背景的逼真人物
- 每个虚拟人物包含：姓名、年龄、性别、职业、教育、地理位置、婚姻状况、民族、政治面貌、宗教信仰、性格特征、核心价值观、个人背景叙述

### 4. 可提取的关键人口统计信息

**核心人口统计**（始终提取）：

- **年龄**：单一年龄、范围（25-35）、或描述（年轻人）
- **性别**：带百分比的分布（男性51.24%，女性48.76%）
- **职业**：职业类型（护士、科技工作者、学生）
- **教育**：从文盲到博士的各级别，带分布权重

**扩展人口统计**（从文本解析）：

- **地理位置**：城乡混合、特定地区、城市
- **婚姻状况**：未婚、已婚、离异、丧偶及百分比
- **民族**：汉族、少数民族分布
- **政治面貌**：群众、党员、团员、民主党派
- **宗教信仰**：无宗教信仰、佛教、道教、基督教、伊斯兰教

**附加背景**（增强背景生成）：

- **收入**：范围或类别（低收入、中等收入、高收入）
- **家庭**：家庭规模、子女数量、家庭结构
- **健康**：健康状况、关注点、慢性病
- **技术**：使用模式、数字素养
- **兴趣**：爱好、活动、偏好
- **价值观**：核心信念、优先事项、世界观

---

## 使用步骤

### 步骤1：连接LLM

**使用AI提取前，必须先连接LLM：**

1. 进入**首页**
2. 选择您的LLM提供商：
   - **LM Studio**（本地、免费、推荐用于中文）
   - **DeepSeek**（API、价格实惠、中文支持优秀）
   - **OpenAI**（API、价格较高、质量良好）
3. 输入API详情：
   - Base URL（例如LM Studio的 `http://localhost:1234/v1`）
   - API密钥（如果需要）
   - 模型名称
4. 点击"测试连接"
5. ✅ 确认出现"连接成功"消息

**💡 推荐**：对于中文人群生成，建议使用LM Studio搭配Qwen2.5或DeepSeek-V3模型以获得最佳效果。

---

### 步骤2：进入AI提取界面

1. 点击侧边栏的**设置**页面
2. 点击**生成虚拟人群**标签
3. 点击**AI智能提取**子标签

您应该看到：

- 大型文本框用于输入人群描述
- 虚拟人群数量滑块（无上限，1000+会显示警告）
- "提取人口统计信息并生成虚拟人群"按钮

---

### 步骤3：编写提示词

**使用下面的综合示例作为模板！**

**最低要求信息：**

- 年龄范围或分布
- 性别分布
- 基本职业或背景

**推荐信息（获得更好结果）：**

- 带分布的教育水平
- 地理位置（城乡、地区）
- 婚姻状况、民族、政治面貌、宗教信仰
- 收入水平
- 价值观和兴趣
- 健康和技术使用情况

**快速入门示例：**

```text
中国城镇居民，年龄25-45岁，男性51.24%，女性48.76%。
教育水平：初中至本科学历为主，涵盖文盲到博士。
城镇居民63.89%，农村居民36.11%。
```

---

### 步骤4：提取并生成

1. **在文本框中粘贴您的人群描述**
2. **设置虚拟人群数量**（例如：100、500、1000）
   - 无上限（但1000+会显示警告）
   - 数量越大，分布越具代表性
3. **点击"提取人口统计信息并生成虚拟人群"**
4. **等待处理**（通常5-30秒）
   - LLM提取：2-5秒
   - 虚拟人群生成：3-25秒（取决于数量）

---

### 步骤5：查看提取的人口统计信息

提取后，您会看到一个**蓝色信息框**显示：

```text
年龄：18-65岁，平均42岁
性别：男性51.24%，女性48.76%
教育：初中至本科学历为主，涵盖文盲到博士学历
职业：企业员工、个体工商户、公务员、...
地理位置：城镇居民63.89%，农村居民36.11%
婚姻状况：已婚68%，未婚22%，离异8%，丧偶2%
民族：汉族91%，少数民族9%
政治面貌：群众70%，党员25%，团员4%，民主党派1%
宗教信仰：无宗教信仰85%，佛教8%，道教3%、...
```

**验证这是否符合您的预期！** 如果不符合，调整提示词后重试。

---

### 步骤6：查看生成的虚拟人物

向下滚动查看**单个虚拟人物**的可展开卡片：

每张卡片显示：

- 👤 姓名、年龄、性别
- 💼 职业
- 🎓 教育程度
- 📍 地理位置
- 💍 婚姻状况
- 🧬 民族
- 🏛️ 政治面貌
- ⛪ 宗教信仰
- 🎨 性格特征（5个特征）
- 💎 核心价值观（5个价值观）
- 📖 个人背景（连贯的中文叙述）

**💡 点击"显示详情"展开并验证虚拟人物是否真实！**

---

### 步骤7：查看人口统计汇总

生成后，滚动到**人口统计特征汇总**：

#### **📊 基本人口统计**（3列布局）

**第1列 - 年龄统计：**

- 平均年龄：42.3岁
- 年龄范围：18-65岁
- 年龄组：
  - 18-25岁：150人（15.0%）
  - 26-35岁：250人（25.0%）
  - 36-45岁：280人（28.0%）
  - 46-55岁：200人（20.0%）
  - 56-65岁：120人（12.0%）

**第2列 - 性别与教育：**

- 性别：男性512人（51.2%），女性488人（48.8%）
- 教育：本科350人（35.0%），初中200人（20.0%），高中180人（18.0%）

**第3列 - 职业与地理位置：**

- 主要职业：企业员工（35%）、个体工商户（15%）、...
- 主要地区：城镇（63.9%）、农村（36.1%）

#### **📊 附加人口统计**（4列布局）

显示以下分布：

- **婚姻状况**：已婚、未婚、离异、丧偶
- **民族**：汉族、回族、满族、蒙古族、...
- **政治面貌**：群众、党员、团员、民主党派
- **宗教信仰**：无宗教信仰、佛教、道教、基督教、...

**✅ 此汇总验证您生成的虚拟人群是否符合目标人口统计特征！**

---

### 步骤8：使用或保存虚拟人群

**选项A：立即用于仿真**

1. 点击**"继续进行仿真"**按钮（右上角）
2. 重定向到仿真页面，虚拟人群已加载
3. 立即开始运行调查

**选项B：永久保存**

1. 点击**"永久保存"**按钮
2. 虚拟人群保存到 `data/personas/` 目录
3. 稍后可从"加载已有虚拟人群"标签加载
4. 跨会话和浏览器刷新持久化

**选项C：导出**

1. 继续后进入仿真页面
2. 点击"导出虚拟人群"下载CSV
3. 分享或存档您生成的人群

---

### 步骤9：迭代和优化

**如果结果不符合预期：**

1. **检查提取的人口统计信息** - LLM解析正确吗？
2. **调整您的提示词** - 添加更具体的百分比
3. **使用不同种子重新生成** - 改变随机分布
4. **增加样本量** - 更大的n = 更准确的分布

**常见调整：**

- ❌ "年轻人为主" → ✅ "年龄25-35岁，平均30岁"
- ❌ "多数是本科" → ✅ "本科占50%，硕士占30%，专科占20%"
- ❌ "城市居民" → ✅ "城镇居民70%，农村居民30%"

---

## 综合提示词示例

### 📋 LLM需要什么信息？

为了生成准确的虚拟人群，请尽可能详细提供：

**1. 人口统计**（他们是谁？）

- 年龄范围或分布
- 带百分比的性别分布
- 教育水平（具体：初中至本科为主，涵盖文盲到博士）
- 职业类型或行业

**2. 地理位置**（他们在哪里？）

- 带百分比的城乡分布
- 特定地区、城市或省份
- 居住安排（城镇居民63.89%，农村居民36.11%）

**3. 社会地位**（他们的背景？）

- 婚姻状况分布（未婚/已婚/离异/丧偶）
- 民族构成（汉族为主占91%，少数民族9%）
- 政治面貌（党员/团员/群众）
- 宗教信仰（无宗教信仰/佛教/道教/基督教）

**4. 经济状况**（财务情况？）

- 收入水平或范围
- 就业状态
- 家庭收入

**5. 心理特征**（他们关心什么？）

- 核心价值观和信念
- 兴趣和爱好
- 关注点或挑战
- 生活方式偏好

**6. 背景信息**（附加细节？）

- 健康状况或关注
- 技术使用情况
- 家庭结构
- 文化背景

---

### 示例1：综合中国人口样本（最全面）

**提示词：**

```text
中国城镇居民调查样本，年龄分布18-65岁，平均年龄42岁。性别分布：男性51.24%，女性48.76%。

教育水平：初中至本科学历为主，涵盖文盲到博士学历。具体分布为：文盲约3%，小学8%，初中20%，高中18%，本科35%，硕士12%，博士4%。

地理分布：城镇居民63.89%，农村居民36.11%。主要分布在东部沿海省份（上海、江苏、浙江、广东）和中西部城市（成都、西安、武汉）。

婚姻状况：已婚占68%，未婚占22%，离异占8%，丧偶占2%。

民族构成：汉族为主占91%，少数民族包括回族、满族、蒙古族等共占9%。

政治面貌：群众占70%，中共党员占25%，共青团员占4%，民主党派占1%。

宗教信仰：无宗教信仰占85%，佛教占8%，道教占3%，基督教占2%，伊斯兰教占1%，其他占1%。

职业分布：企业员工35%，个体工商户15%，公务员和事业单位人员12%，农民工10%，自由职业者8%，退休人员10%，学生5%，其他5%。

收入水平：低收入（年收入3万以下）20%，中等收入（3-10万）50%，中高收入（10-20万）20%，高收入（20万以上）10%。

家庭结构：核心家庭（夫妻+子女）占60%，三代同堂占25%，独居占10%，其他占5%。平均家庭人口3.2人。

健康状况：健康占70%，亚健康占20%，慢性病患者占8%，残疾人占2%。

技术使用：智能手机使用率95%，互联网使用率90%，电子支付使用率85%。

核心价值观：重视家庭和睦（90%），追求经济收入（75%），关注子女教育（80%），注重社会地位（55%），追求个人发展（65%）。

主要关注：子女教育、医疗健康、养老保障、住房问题、就业稳定。
```

**为什么这个有效：**

- ✅ 所有主要人口统计信息都有精确百分比（性别、教育、地理位置等）
- ✅ 综合覆盖9个以上人口统计维度
- ✅ 使用自然语言描述指示分布（"为主"、"涵盖"）
- ✅ 背景信息（收入、家庭、健康、技术）
- ✅ 价值观和关注点用于生成真实的背景叙述

---

### 示例2：科技从业者

**提示词：**

```text
科技行业从业人员，年龄25-40岁，平均年龄32岁。性别分布：男性65%，女性35%。

教育背景：本科学历占50%，硕士学历占40%，博士学历占7%，专科及以下占3%。
主要专业：计算机科学、软件工程、数据科学、信息技术。

地理位置：一线城市占70%（北京30%、上海25%、深圳15%），新一线城市占25%（杭州、成都、西安），其他城市占5%。
城镇居民98%，农村2%。

婚姻状况：未婚占55%，已婚占40%，离异占4%，丧偶占1%。

职业分布：软件工程师45%，产品经理15%，数据分析师12%，UI/UX设计师10%，
项目经理8%，技术管理5%，其他5%。

收入水平：年薪15-30万占40%，30-50万占35%，50-80万占15%，80万以上占7%，15万以下占3%。

民族：汉族占95%，少数民族占5%。

政治面貌：群众75%，党员18%，团员6%，其他1%。

宗教：无宗教信仰95%，佛教2%，基督教2%，其他1%。

工作强度：每周工作50-60小时，实行弹性工作制，可远程办公。

技术水平：精通至少2门编程语言，熟悉云计算平台，了解AI/机器学习基础。

核心价值观：技术创新、职业发展、高薪酬、工作灵活性、终身学习、技术社区参与。

生活方式：注重效率，依赖科技产品，偏好线上购物和外卖，关注科技新闻和趋势，
参与开源项目，活跃于技术论坛。

主要关注：职业晋升、技能提升、行业趋势、工作压力、生活平衡、股权激励。

健康状况：亚健康占35%（颈椎病、腰椎病、视力下降、睡眠不足），健康占60%，其他占5%。

兴趣爱好：编程、游戏、科技产品评测、户外运动（跑步、骑行）、阅读技术书籍、
参加技术会议和Meetup。
```

**为什么这很全面：**

- ✅ 9个人口统计维度都有精确百分比
- ✅ 职业细分为7个具体角色
- ✅ 收入分层为5个级别
- ✅ 工作环境细节（工作时长、远程办公）
- ✅ 技术技能和熟练程度
- ✅ 生活方式模式和行为
- ✅ 特定职业的健康考虑

---

### 示例3：老年群体

**提示词：**

```text
退休老年人群体，年龄65-85岁。年龄段分布：65-70岁占35%，71-75岁占30%，76-80岁占20%，81-85岁占15%。
性别：女性55%，男性45%。

教育水平：初中及以下占45%，高中占30%，本科占20%，硕士及以上占5%。

居住地：城镇居民60%，农村居民40%。地区分布：东部地区40%，中部地区30%，西部地区20%，东北地区10%。

婚姻状况：已婚占60%，丧偶占35%，离异占4%，未婚占1%。

民族：汉族93%，少数民族7%。

政治面貌：群众55%，党员40%，民主党派4%，团员1%。

宗教信仰：无宗教信仰70%，佛教20%，道教5%，基督教3%，其他2%。

退休前职业：企业职工35%，公务员和事业单位25%，农民20%，个体工商户10%，
教师8%，其他2%。

收入来源：退休金/养老金占主要来源（平均每月2000-4000元）。低收入（2000以下）30%，
中等收入（2000-4000）45%，中高收入（4000-6000）15%，高收入（6000以上）10%。

居住安排：与配偶同住占50%，独居占20%，与子女同住占25%，养老院占3%，其他占2%。

家庭结构：有子女占95%（平均2.1个子女），有孙子女占85%。

健康状况：健康占30%，患有慢性病占60%（高血压、糖尿病、心脏病、关节炎等），
失能/半失能占8%，其他占2%。

日常活动：广场舞/健身操40%，看电视/听广播80%，照顾孙辈50%，社区活动30%，
打牌/下棋25%，园艺/养花20%，志愿服务15%，旅游10%。

技术使用：智能手机使用60%（主要用于微信、视频通话），互联网使用40%，
电子支付使用35%，不使用智能设备40%。

核心价值观：重视家庭和睦（95%），关注健康养生（90%），追求晚年幸福（85%），
注重传统文化（70%），关心社区邻里（65%）。

主要关注：身体健康、医疗保障、养老金充足性、子女发展、孙辈教育、
防诈骗安全、社交活动、晚年生活质量。

生活节奏：早睡早起（平均6:00起床，21:00就寝），规律饮食，注重养生保健，
参与社区活动，保持社交联系。
```

**全面覆盖：**

- 老年范围内的年龄子组
- 详细的健康状况（对此人群至关重要）
- 居住安排和家庭结构
- 技术采用率（代际数字鸿沟）
- 日常活动和生活方式
- 财务状况（退休收入）
- 特定生命阶段的价值观

---

### 示例4：大学生群体

**提示词：**

```text
中国大学生群体，年龄18-24岁。年龄分布：18-19岁25%，20-21岁35%，22-23岁30%，24岁以上10%。
性别：女性60%，男性40%。

教育：在读 - 大一25%，大二25%，大三25%，大四20%，研究生5%。

专业领域：理工科35%，商科20%，社会科学15%，艺术人文12%，
医学健康10%，教育5%，其他3%。

地理位置：城市校区70%，郊区校区25%，农村校区5%。
生源地：本省70%，外省25%，国际学生5%。

民族：汉族85%，少数民族15%（回族、满族、蒙古族、藏族、维吾尔族等）。

婚姻状况：未婚95%，已婚4%，其他1%。

家庭收入：0-5万20%，5-10万25%，10-20万30%，20万以上25%。

住宿：校内宿舍40%，校外租房35%，与父母同住20%，其他5%。

就业：未就业40%，兼职45%，全职10%，实习5%。

经济状况：获得助学金60%，助学贷款45%，奖学金30%，家庭支持70%。

政治面貌：群众60%，团员38%，党员1%，其他1%。

宗教信仰：无宗教信仰90%，佛教5%，基督教3%，伊斯兰教1%，其他1%。

价值观：教育和职业成功（最高），工作生活平衡，社会责任，
多样性和包容性，环境可持续性，心理健康意识。

技术：智能手机拥有率99%，笔记本电脑拥有率95%，社交媒体使用95%，
在线学习平台90%，视频流媒体95%。

关注点：学业表现、职业前景、学生贷款、心理健康、
生活成本、社交关系、实习机会。

兴趣：社交媒体、音乐和演唱会、体育健身、电子游戏、
旅游、志愿服务、校园社团活动。

健康：总体健康80%，心理健康问题（焦虑25%，抑郁15%），
睡眠不足40%，压力相关问题35%。
```

**关键特征：**

- 年龄子组带百分比
- 学年分布
- 专业领域细分
- 多个地理维度
- 民族多样性
- 详细的财务背景
- 技术采用率
- 心理健康考虑

---

### 示例5：医护人员

**提示词：**

```text
医护人员群体，年龄28-55岁，高峰分布在35-45岁。
性别：女性80%，男性20%。

教育：护理专业本科或大专占75%，医疗管理硕士15%，
护理文凭或证书课程10%。

地理位置：在城市医院工作85%，农村医疗中心15%。
主要位于：北京、上海、广州、深圳、成都、武汉、杭州。

婚姻状况：已婚65%，未婚25%，离异8%，丧偶2%。

民族：汉族90%，少数民族10%。

政治面貌：群众65%，党员30%，团员4%，其他1%。

宗教信仰：无宗教信仰85%，佛教10%，基督教3%，其他2%。

职业：注册护士60%，执业护士20%，护士从业者10%，
医疗管理人员5%，其他医疗支持人员5%。

收入：年薪8-15万，注册护士平均12万，护士从业者平均18万。
低收入（8万以下）15%，中等收入（8-15万）60%，
高收入（15万以上）25%。

核心价值观：患者护理（最高优先级）、工作生活平衡、职业发展、
医疗可及性、同情心、道德实践、团队协作。

工作挑战：长工作时间（经常12小时轮班）、高压力环境、
情绪倦怠、人手不足问题、接触疾病风险、夜班影响。

健康状况：总体注重健康，但背痛发生率较高（50%），
压力相关疾病（30%），睡眠障碍（40%）由于轮班工作。

技术使用：熟练使用电子病历系统95%，医疗设备操作100%，
智能手机使用98%，在线医学资源90%。

兴趣：医学继续教育、健身和养生、家庭时间、
阅读（尤其是医学期刊）、社区健康志愿工作、瑜伽和冥想。

主要关注：职业倦怠预防、护患比例、薪酬福利、职业安全、
继续教育机会、心理健康支持、家庭照顾责任平衡。
```

**提取内容：**

- 年龄28-55范围，正态分布
- 性别80/20女/男比例
- 3个教育等级带具体百分比
- 城乡85/15分布
- 5个具体职业角色带百分比
- 加上：收入、价值观、工作挑战，用于丰富背景

---

## 🎯 编写有效提示词的技巧

### ✅ 应该做：

- **尽可能使用百分比**（男性51.24%，女性48.76%）
- **指定范围**用于连续变量（年龄25-35，收入5-10万）
- **包含分布关键词**（为主、涵盖、包括、从...到...）
- **提供背景**（为什么重要，他们关心什么）
- **具体到类别**（初中、高中、本科，而不是笼统的"受过教育"）
- **覆盖多个维度**（至少5-6个人口统计字段）
- **添加定性细节**（价值观、关注点、行为）

### ❌ 不应该做：

- 使用模糊术语（"一些"、"许多"、"大多数"而没有数字）
- 省略重要人口统计信息（年龄、性别、教育基础）
- 提供矛盾信息
- 只用英文或只用中文 - 混合使用也可以！
- 忘记背景信息（生活方式、价值观、关注点）
- 有百分比时不提供

### 💡 专业提示：

1. **从基础开始**：年龄、性别、教育、地理位置
2. **添加社会背景**：婚姻状况、民族、宗教、政治面貌
3. **包含经济信息**：收入、就业、财务状况
4. **描述生活方式**：技术使用、兴趣、日常活动
5. **解释价值观**：他们重视什么，担心什么
6. **提及健康**：身体和心理健康考虑

---

## 技术实现

### 架构概述

```text
用户输入（自然语言）
         ↓
AI提取（LLM分析）
         ↓
JSON人口统计数据
         ↓
智能解析器（7+个专用解析器）
         ↓
统计分布
         ↓
PersonaGenerator引擎
         ↓
生成的虚拟人群（带连贯背景）
```

### 修改的文件

1. **`src/persona_generator.py`** (952行)
   - `extract_demographics_with_ai()` - 使用专门提示词的AI提取
   - `generate_personas_from_ai_extraction()` - 分布创建和生成
   - `_generate_background()` - 连贯的中文叙述生成
   - **7个智能解析器**：
     - 教育解析器（处理"涵盖"、"至"等范围关键词）
     - 地理位置解析器（提取城乡百分比）
     - 性别解析器（精确百分比的正则表达式）
     - 婚姻状况解析器（关键词检测+权重）
     - 民族解析器（汉族+少数民族）
     - 政治面貌解析器（党员/团员/群众）
     - 宗教解析器（5+主要宗教）

2. **`pages/1_Setup.py`** (1413行)
   - AI智能提取标签UI
   - 人口统计提取和显示
   - 综合统计汇总（9个维度）
   - 与PersonaManager集成
   - `Persona.from_dict()` 保留所有字段（包括动态属性）

3. **`src/persona.py`** (272行)
   - 扩展的Persona数据类，新增4个固定字段
   - `_extra_attributes` 用于无限动态字段
   - `__setattr__`/`__getattr__` 处理动态属性
   - `from_dict()` 类方法进行正确的反序列化

### 智能解析器详情

#### 1. 教育解析器（第633-680行）

```python
# 检测范围关键词：涵盖、包括、从、到、至
has_range = any(keyword in education_str for keyword in ['涵盖', '包括', '从', '到', '至'])

if has_range:
    # 包含全部7个等级：文盲、小学、初中、高中、本科、硕士、博士
    # 对带"为主"的等级提升权重
```

**输入**："初中至本科学历为主，涵盖文盲到博士"

**输出**：全部7个等级带权重 → 初中(32%)、本科(35%)、其他(33%)

#### 2. 性别解析器（第588-631行）

```python
# 正则表达式: r'male[:\s]*\(?(\d+\.?\d*)\s*%'
male_match = re.search(r'male[:\s]*\(?(\d+\.?\d*)\s*%', gender_str, re.IGNORECASE)
```

**输入**："性别：男性51.24%，女性48.76%"

**输出**：精确分布 [0.5124, 0.4876]

#### 3. 地理位置解析器（第682-710行）

```python
# 正则表达式: r'城镇[居民]*[占]*\s*(\d+\.?\d*)\s*%'
urban_match = re.search(r'城镇[居民]*[占]*\s*(\d+\.?\d*)\s*%', location_str)
```

**输入**："城镇居民63.89%，农村居民36.11%"

**输出**：['城镇', '农村'] 权重 [0.6389, 0.3611]

#### 4-7. 状态解析器（第712-820行）

类似模式用于：

- 婚姻状况（未婚/已婚/离异/丧偶）
- 民族（汉族+55个少数民族）
- 政治面貌（群众/党员/团员/民主党派）
- 宗教（无宗教信仰/佛教/道教/基督教/伊斯兰教）

---

## 优势

1. **速度快**：几秒钟内从文本生成虚拟人群
2. **准确性高**：AI提取细微的人口统计细节
3. **灵活性强**：适用于任何文本描述
4. **自然便捷**：无需理解统计分布
5. **全面覆盖**：捕获数值和分类属性
6. **可验证性**：人口统计汇总表验证生成的人群

---

## 局限性

1. 需要活跃的LLM连接
2. 质量取决于LLM能力
3. 复杂描述可能需要多次尝试
4. 如果LLM响应格式错误，JSON解析可能失败
5. 非常大的虚拟人群（1000+）生成可能需要较长时间

---

## 未来增强

- [ ] 支持上传研究论文/PDF
- [ ] 输入文本的多语言支持
- [ ] 生成前编辑/优化提取的人口统计信息的能力
- [ ] 保存提取模板以供重用
- [ ] 批处理多个文本描述
- [ ] 与外部人口统计数据库集成
- [ ] 可视化人口统计分布（图表）
- [ ] 导出综合人口统计报告为PDF

---

## 测试

在UI中测试：

```bash
streamlit run app.py
```

然后：

1. 进入首页连接LLM
2. 进入设置页面 → 生成虚拟人群 → AI智能提取
3. 粘贴上面的示例提示词之一
4. 点击"提取人口统计信息并生成虚拟人群"
5. 查看结果并验证准确性

---

## 故障排除

**问题**："LLM未连接"警告

- **解决方案**：先进入首页连接LLM

**问题**："无法将AI响应解析为JSON"

- **解决方案**：使用更清晰的文本重试，或检查LLM日志

**问题**：提取的人口统计信息看起来不正确

- **解决方案**：在输入文本中提供更具体的细节

**问题**：生成的虚拟人群不匹配描述

- **解决方案**：查看提取的人口统计信息，使用不同种子重新生成

**问题**：只生成了部分教育等级

- **解决方案**：在提示词中使用范围关键词，例如"涵盖文盲到博士"或"从初中至本科"

**问题**：性别分布不准确

- **解决方案**：使用精确百分比，例如"男性51.24%，女性48.76%"而不是"男性为主"

---

## 许可证

与父项目相同

## 问题？

请在GitHub上使用"ai-extraction"标签提交问题
